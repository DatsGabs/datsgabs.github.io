<!doctype html><html lang=en prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Gabriel Lazcano"><title>Import 3D models to three.js [outdated]</title><meta name=twitter:card content="summary"><meta name=twitter:site content="@datsgabs"><meta name=twitter:creator content="@datsgabs"><meta name=twitter:image content="https://gabriellazcano.com/images/habbo-card.png"><meta property="og:title" content="Import 3D models to three.js [outdated]"><meta property="og:description" content="In this post I'm going to explain how to easily import 3D objects to threejs and how to structure a simple scene"><meta property="og:type" content="article"><meta property="og:image" content="https://gabriellazcano.com/images/habbo-card.png"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://gabriellazcano.com"><meta property="og:sitename" content="Gabriel Lazcano"><meta name=twitter:dnt content="on"><link rel="shortcut icon" href=/images/habbo-card.png type=image/png><link rel=stylesheet href=https://gabriellazcano.com/scss/commons/index.min.dbdcf063115b08f45de46c6639dfffa1d0ba9ea89d4fdb64ebc28ffe7724b24d.css><link rel=stylesheet href=https://gabriellazcano.com/scss/single/index.min.5e9a73e63af6e44e0ccc5e0d3e0da22987dab98c2b8474f1dbbbdbe978c54684.css></head><body><div class=container><nav class=navigation><a class=navigation_home-button href=/ title="Press to go Home"><img width=80 height=80 src=/images/habbo.png alt="Gabriel Lazcano"></a><h1 class="navigation_header navigation_mobile--hiden">Gabriel Lazcano</h1><p class=navigation_mobile--hiden>Fullstack web developer, living in Mexico</p><div class="social-media navigation_mobile--hiden"><a href=https://github.com/datsgabs><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a href=https://twitter.com/datsgabs><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Twitter icon</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958.0 002.163-2.723c-.951.555-2.005.959-3.127 1.184A4.92 4.92.0 0011.78 8.288C7.69 8.095 4.067 6.13 1.64 3.162A4.822 4.822.0 00.974 5.637c0 1.71.87 3.213 2.188 4.096A4.904 4.904.0 01.934 9.117v.06a4.923 4.923.0 003.946 4.827 4.996 4.996.0 01-2.212.085 4.936 4.936.0 004.604 3.417A9.867 9.867.0 011.17 19.611c-.39.0-.779-.023-1.17-.067a13.995 13.995.0 007.557 2.209c9.053.0 13.998-7.496 13.998-13.985.0-.21.0-.42-.015-.63A9.935 9.935.0 0024 4.59z"/></svg></a><a href=/index.xml><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>RSS icon</title><path d="M19.199 24C19.199 13.467 10.533 4.8.0 4.8V0c13.165.0 24 10.835 24 24h-4.801zM3.291 17.415c1.814.0 3.293 1.479 3.293 3.295.0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526.0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727.0 15.909 7.184 15.909 15.91z"/></svg></a></div><div class=navigation_menu id=links><a href=/tags title>Tags</a>
<a href=/archive title>Archive</a>
<a href=/newsletter title>Newsletter</a><br><hr><br><small>Â© 2021 Gabriel Lazcano</small></div><div class=navigation_hamburger id=hamburger><div class="hamburger_line half start"></div><div class=hamburger_line></div><div class="hamburger_line half end"></div></div><script src=/js/hamburger-menu.min.2e543bcb3025aea643d9d2fede961bb233bbad382ccfcff590f4310085774c41.js defer></script></nav><main class=main><div class=single-header><h1 class=single-header_title>Import 3D models to three.js [outdated]</h1><p class=title-footnote>Published on <b>Mar 8, 2021</b></p><p class=title-footnote>Reading time <b>3 min</b></p></div><article id=article class=article><p>I&rsquo;ve found threejs pretty tricky at the current state of the library. They are always making improvements and breaking some applications with the new updates. So here, I"m going to talk about how I&rsquo;ve found it&rsquo;s good to structure your threejs application for importing 3D objects. Here is a working example.</p><iframe srcdoc="
<!DOCTYPE html>
<html>
	<head>
		<style>
			body { margin: 0; }
		</style>
	</head>
	<body>
		<script type=&#34;module&#34;>
			import * as THREE from 'https://cdn.skypack.dev/pin/three@v0.130.0-WI96Ec9p8dZb5AMcOcgD/mode=imports,min/optimized/three.js';
            import { OrbitControls } from 'https://cdn.skypack.dev/pin/three@v0.130.0-WI96Ec9p8dZb5AMcOcgD/mode=imports,min/unoptimized/examples/jsm/controls/OrbitControls.js';
            import { GLTFLoader } from 'https://cdn.skypack.dev/pin/three@v0.130.0-WI96Ec9p8dZb5AMcOcgD/mode=raw,min/examples/jsm/controls/GLTFLoader.js'

            let camera, scene, renderer, loader, model;

            const delay = 250

            init();
            animate()

            function init () {
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
                renderer = new THREE.WebGLRenderer({ antialias: true})
                loader = new GLTFLoader();

                renderer.setSize( window.innerWidth, window.innerHeight );
                renderer.setClearColor(&#34;#121212&#34;)
                document.body.appendChild( renderer.domElement );

                camera.position.z = 3;

                const controls = new OrbitControls(camera, renderer.domElement);

                // ambient light
                const ambientLight = new THREE.AmbientLight ( 0xffffff, 0.2)
                scene.add( ambientLight )

                // point light
                const pointLight = new THREE.PointLight( 0xffffff, 1 );
                pointLight.position.set( 30, 50, 25 );
                scene.add( pointLight );

                window.addEventListener( 'resize', () => {
                    throttle(onWindowResize(), delay)
                } );

                loader.load( '/models/skull_downloadable/scene.gltf', function ( gltf ) {
                    model = gltf.scene
                    scene.add( model );

                }, undefined, function ( error ) {
                    console.error( error );
                } );
            }

            function throttle(callback, limit) {
                console.log('hola')
                let wait = false
                return function () {
                    if (!wait) {
                    callback.apply(null, arguments)
                    wait = true
                    setTimeout(function () {
                        wait = false
                    }, limit)
                    }
                }
            }

            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize( window.innerWidth, window.innerHeight );
            }

            function animate() {
                requestAnimationFrame( animate );
                if (model) {
                    model.rotation.y -= 0.01
                }     
                renderer.render( scene, camera );
            }
		</script>
	</body>
</html>
" frameborder=0 height=250px width=100% sandbox="allow-same-origin allow-scripts"></iframe><h2 id=basic-setup>Basic Setup</h2><p>The current version of threejs doesn&rsquo;t require any special tags in the HTML, only the <code>&lt;script type="module"></code> tag where we are going to develop the logic of the program.</p><p>When using <code>type="module"</code> we can use the features of es5 such as <code>import</code> so we are going to use them. We have to import <code>threejs</code> and <code>GLTFLoader</code>. And any other component you use, such as <code>OrbitControls</code>. I&rsquo;m going to define some variables gloablly as I&rsquo;m assigning them afterwards in the <code>init()</code> function. You can extend on the configuration in this function <a href=https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene>in the documentation</a></p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kr>import</span> <span class=o>*</span> <span class=nx>as</span> <span class=nx>THREE</span> <span class=nx>from</span> <span class=s1>&#39;https://unpkg.com/three@0.126.1/build/three.module.js&#39;</span><span class=p>;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>GLTFLoader</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;https://unpkg.com/three/examples/jsm/loaders/GLTFLoader.js&#39;</span>

<span class=kd>let</span> <span class=nx>camera</span><span class=p>,</span> <span class=nx>scene</span><span class=p>,</span> <span class=nx>renderer</span><span class=p>,</span> <span class=nx>loader</span><span class=p>,</span> <span class=nx>model</span><span class=p>;</span>

<span class=nx>init</span><span class=p>();</span>
<span class=nx>animate</span><span class=p>()</span>

<span class=kd>function</span> <span class=nx>init</span> <span class=p>()</span> <span class=p>{</span>
    <span class=nx>scene</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>THREE</span><span class=p>.</span><span class=nx>Scene</span><span class=p>();</span>
    <span class=nx>camera</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>THREE</span><span class=p>.</span><span class=nx>PerspectiveCamera</span><span class=p>(</span> <span class=mi>75</span><span class=p>,</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerWidth</span> <span class=o>/</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerHeight</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mi>1000</span> <span class=p>);</span>
    <span class=nx>renderer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>THREE</span><span class=p>.</span><span class=nx>WebGLRenderer</span><span class=p>({</span> <span class=nx>antialias</span><span class=o>:</span> <span class=kc>true</span><span class=p>})</span>
    <span class=nx>loader</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GLTFLoader</span><span class=p>();</span>

    <span class=c1>// renderer
</span><span class=c1></span>    <span class=nx>renderer</span><span class=p>.</span><span class=nx>setSize</span><span class=p>(</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerWidth</span><span class=p>,</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerHeight</span> <span class=p>);</span>
    <span class=nx>renderer</span><span class=p>.</span><span class=nx>setClearColor</span><span class=p>(</span><span class=s2>&#34;#121212&#34;</span><span class=p>)</span> <span class=c1>// set the background color
</span><span class=c1></span>    <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span> <span class=nx>renderer</span><span class=p>.</span><span class=nx>domElement</span> <span class=p>);</span>

    <span class=nx>camera</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=nx>z</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>animate</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>requestAnimationFrame</span><span class=p>(</span> <span class=nx>animate</span> <span class=p>);</span>
    <span class=nx>renderer</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span> <span class=nx>scene</span><span class=p>,</span> <span class=nx>camera</span> <span class=p>);</span>
<span class=p>}</span></code></pre></div><p>For adjusting the size when changing resizing the window we have to add an event listener and to change both the aspect ratio and the size of the renderer.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kd>function</span> <span class=nx>init</span> <span class=p>()</span> <span class=p>{</span>
    <span class=c1>// ...
</span><span class=c1></span>    <span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;resize&#39;</span><span class=p>,</span> <span class=nx>onWindowResize</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>onWindowResize</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>camera</span><span class=p>.</span><span class=nx>aspect</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerWidth</span> <span class=o>/</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerHeight</span><span class=p>;</span>
    <span class=nx>camera</span><span class=p>.</span><span class=nx>updateProjectionMatrix</span><span class=p>();</span>
    <span class=nx>renderer</span><span class=p>.</span><span class=nx>setSize</span><span class=p>(</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerWidth</span><span class=p>,</span> <span class=nb>window</span><span class=p>.</span><span class=nx>innerHeight</span> <span class=p>);</span>
<span class=p>}</span></code></pre></div><h2 id=loading-object>Loading object</h2><p>Now we have to load the object and define the lighting for the scene.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kd>function</span> <span class=nx>init</span> <span class=p>()</span> <span class=p>{</span>
    <span class=c1>// ...
</span><span class=c1></span>
    <span class=c1>// ambient light
</span><span class=c1></span>    <span class=kr>const</span> <span class=nx>ambientLight</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>THREE</span><span class=p>.</span><span class=nx>AmbientLight</span> <span class=p>(</span> <span class=mh>0xffffff</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>)</span>
    <span class=nx>scene</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span> <span class=nx>ambientLight</span> <span class=p>)</span>

    <span class=c1>// point light
</span><span class=c1></span>    <span class=kr>const</span> <span class=nx>pointLight</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>THREE</span><span class=p>.</span><span class=nx>PointLight</span><span class=p>(</span> <span class=mh>0xffffff</span><span class=p>,</span> <span class=mi>1</span> <span class=p>);</span>
    <span class=nx>pointLight</span><span class=p>.</span><span class=nx>position</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>25</span> <span class=p>);</span>
    <span class=nx>scene</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span> <span class=nx>pointLight</span> <span class=p>);</span>

    <span class=nx>loader</span><span class=p>.</span><span class=nx>load</span><span class=p>(</span> <span class=s1>&#39;/path/to/object.gltf&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span> <span class=nx>gltf</span> <span class=p>)</span> <span class=p>{</span>
        <span class=nx>model</span> <span class=o>=</span> <span class=nx>gltf</span><span class=p>.</span><span class=nx>scene</span> <span class=c1>// assign the model to the global variable
</span><span class=c1></span>        <span class=nx>scene</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span> <span class=nx>model</span> <span class=p>);</span>

    <span class=p>},</span> <span class=kc>undefined</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span> <span class=nx>error</span> <span class=p>)</span> <span class=p>{</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span> <span class=nx>error</span> <span class=p>);</span>
    <span class=p>}</span> <span class=p>);</span>
<span class=p>}</span></code></pre></div><h2 id=animation>Animation</h2><p>To add a simple animation rotation to the model we have to add or substract to the rotation of the object in every animation frame, for example. However, there are much more ways of animating and with different purposes.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kd>function</span> <span class=nx>animate</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>requestAnimationFrame</span><span class=p>(</span> <span class=nx>animate</span> <span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>model</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>model</span><span class=p>.</span><span class=nx>rotation</span><span class=p>.</span><span class=nx>y</span> <span class=o>-=</span> <span class=mf>0.01</span>
    <span class=p>}</span>     
    <span class=nx>renderer</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span> <span class=nx>scene</span><span class=p>,</span> <span class=nx>camera</span> <span class=p>);</span>
<span class=p>}</span></code></pre></div><h3 id=complete-implementation>Complete implementation</h3><p>You can check to the complete implementation in <a href=https://gist.github.com/DatsGabs/0a5dd2d1a2d8c63b6d8390a84b3434f9>this Github gist</a>.</p><div class=article-bottom><a href="https://twitter.com/intent/tweet?text=Import%203D%20models%20to%20three.js%20%5boutdated%5d&url=https%3a%2f%2fgabriellazcano.com%2fblog%2fimport-models-to-three-js%2f&via=datsgabs" target=_blank rel="noopener noreferrer" class="share-twitter-btn article-bottom_btn"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958.0 002.163-2.723c-.951.555-2.005.959-3.127 1.184A4.92 4.92.0 0011.78 8.288C7.69 8.095 4.067 6.13 1.64 3.162A4.822 4.822.0 00.974 5.637c0 1.71.87 3.213 2.188 4.096A4.904 4.904.0 01.934 9.117v.06a4.923 4.923.0 003.946 4.827 4.996 4.996.0 01-2.212.085 4.936 4.936.0 004.604 3.417A9.867 9.867.0 011.17 19.611c-.39.0-.779-.023-1.17-.067a13.995 13.995.0 007.557 2.209c9.053.0 13.998-7.496 13.998-13.985.0-.21.0-.42-.015-.63A9.935 9.935.0 0024 4.59z"/></svg><span>Share on Twitter</span></a>
<a href=/newsletter class="newsletter-btn article-bottom_btn">Join newsletter</a></div></article><div class=single_pagination><div class=pagination_title><span class=pagination_title-h>Read other posts</span></div><div class=pagination_buttons><span class="button previous"><a href=https://gabriellazcano.com/blog/why-i-use-quokka.js-for-prototyping/><span class=button_icon>â</span>
<span class=button_text>Why I Use Quokka.js for prototyping?</span></a></span>
<span class="button next"><a href=https://gabriellazcano.com/blog/create-an-isolated-iframe/><span class=button_text>Create a secure Isolated Iframe</span>
<span class=button_icon>â</span></a></span></div></div></main><aside><div class=toc><nav id=TableOfContents><ul><li><a href=#basic-setup>Basic Setup</a></li><li><a href=#loading-object>Loading object</a></li><li><a href=#animation>Animation</a><ul><li><a href=#complete-implementation>Complete implementation</a></li></ul></li></ul></nav></div><script src=/js/toc.min.c516e3034a21413df5bf5d9249d861cb7f7bd2a914715f4ef79c122e8f38921c.js></script></aside></div><script src=/js/clickable-box.min.bbd9f6756183352f2862ee000ab3f9c168fa3b03e076ef267e0eda619c45f960.js defer></script><script src=/js/index.min.a436abe5aff433351a616bc69213e540156f65138a3b6690d6bdf7a60df7ebe5.js defer></script></body></html>